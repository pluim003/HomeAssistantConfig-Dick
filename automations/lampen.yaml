# lampen.yaml
# v2022.01.03
#
# History:
#
# v2022.01.03 - Initial version
#               Added light on when irradiance is low and off when it gets higher
#               Light won't go out at sunrise then irradiance is too low
#               Modified again as it would only work between sunrise and sunset
#               Removed light off at sunrise and replaced that with light on at
#               specific time unless it's too bright outside
#
# This file contains automations for lights
#

# lamp uit in 'homeoffice' op werkdagen als zon op komt

- id: lamp_michel_aan_voor_werk
  alias: Lamp Michel aan voor werk
  trigger:
  - platform: time
    at: "07:10:00"
  - platform: numeric_state
    entity_id: sensor.buienradar_irradiance
    value_template: "{{ states.sensor.buienradar_irradiance.state | float }}"
    below: 10
  condition:
    - condition: time
      weekday:
      - mon
      - tue
      - thu
      - fri    
    - condition: state
      entity_id: light.lamp_michel
      state: "off"
  action:
    service: light.turn_on
    entity_id: light.lamp_michel
    
- id: lamp_michel_uit_als_buiten_licht_genoeg
  alias: Lamp Michel uit als buiten licht genoeg
  trigger:
  - platform: numeric_state
    entity_id: sensor.buienradar_irradiance
    value_template: "{{ states.sensor.buienradar_irradiance.state | float }}"
    above: 10
  condition:
    - condition: time
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
    - condition: state
      entity_id: light.lamp_michel
      state: "on"
  action:
    service: light.turn_off
    entity_id: light.lamp_michel    

- id: lamp_michel_aan_als_buiten_te_donker
  alias: Lamp Michel aan als buiten te donker
  trigger:
  - platform: numeric_state
    entity_id: sensor.buienradar_irradiance
    value_template: "{{ states.sensor.buienradar_irradiance.state | float }}"
    below: 10
  condition:
    - condition: time
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
    - condition: state
      entity_id: light.lamp_michel
      state: "off"
    - condition: time
      before: "17:00:00"
  action:
    service: light.turn_on
    entity_id: light.lamp_michel    
